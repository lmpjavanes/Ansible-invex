host,checked_at,status,message,package,file,version_installed,install_date,service_active,command_install,command_validate,command_token,command_start,command_status,vendor,summary,description
{% for hostres in (audit_linux | default([])) -%}
{%- set hstatus = hostres.status | default('ok') -%}
{%- if hstatus == 'unavailable' -%}
{{ hostres.host | default('') }},{{ hostres.checked_at | default('') }},unavailable,"{{ (hostres.message | default('Servidor no disponible') | string | trim | regex_replace('[\r\n]+',' ') | replace('"','""')) }}",,,,,,,,,,,,,
{%- else -%}
{%- for pkg in (hostres.packages | default([])) -%}
{{ hostres.host | default('') }},{{ pkg.checked_at | default(hostres.checked_at | default('')) }},ok,,{{ pkg.package | default('') }},{{ pkg.file | default('') }},{{ pkg.version_installed | default('') }},{{ pkg.checked_at | default('') }},{{ pkg.service_active | default('') }},"{{ (pkg.command_install | default('') | string | trim | regex_replace('[\r\n]+',' ') | replace('"','""')) }}","{{ (pkg.command_validate | default('') | string | trim | regex_replace('[\r\n]+',' ') | replace('"','""')) }}","{{ (pkg.command_token | default('') | string | trim | regex_replace('[\r\n]+',' ') | replace('"','""')) }}","{{ (pkg.command_start | default('') | string | trim | regex_replace('[\r\n]+',' ') | replace('"','""')) }}","{{ (pkg.command_status | default('') | string | trim | regex_replace('[\r\n]+',' ') | replace('"','""')) }}","{{ (pkg.vendor | default('') | string | trim | regex_replace('[\r\n]+',' ') | replace('"','""')) }}","{{ (pkg.summary | default('') | string | trim | regex_replace('[\r\n]+',' ') | replace('"','""')) }}","{{ (pkg.description | default('') | string | trim | regex_replace('[\r\n]+',' ') | replace('"','""')) }}"
{%- endfor -%}
{%- endif -%}
{%- endfor -%}
