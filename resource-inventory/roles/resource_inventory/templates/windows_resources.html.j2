<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Windows Resource Inventory</title>
  <style>
    body { font-family: Arial, sans-serif; }
    table { border-collapse: collapse; width: 100%; }
    th, td { border: 1px solid #ddd; padding: 8px; vertical-align: top; }
    th { background: #f2f2f2; }
    pre { white-space: pre-wrap; word-wrap: break-word; margin: 0; }
    .bad { color: #b00020; font-weight: bold; }
  </style>
</head>
<body>
  <h2>Windows Resource Inventory</h2>
  {% for hostres in (audit_windows | default([])) %}
    <h3>{{ hostres.host }}</h3>
    <p>
      <b>Checked at:</b> {{ hostres.checked_at }} |
      <b>Status:</b>
      {% if hostres.status == 'unavailable' %}<span class="bad">unavailable</span>{% else %}ok{% endif %}
    </p>

    {% if hostres.status == 'unavailable' %}
      <p class="bad">{{ hostres.message | default('Servidor no disponible') }}</p>
    {% else %}
      <table>
        <tr>
          <th>Command</th>
          <th>RC</th>
          <th>STDOUT</th>
          <th>STDERR</th>
        </tr>
        {% for cmd in (hostres.commands | default([])) %}
        <tr>
          <td><b>{{ cmd.name }}</b><br><pre>{{ cmd.command }}</pre></td>
          <td>{{ cmd.rc }}</td>
          <td><pre>{{ cmd.stdout }}</pre></td>
          <td><pre>{{ cmd.stderr }}</pre></td>
        </tr>
        {% endfor %}
      </table>
    {% endif %}
  {% endfor %}
</body>
</html>
